{{ block title }}
		{{ if stage == "basic"}}
			Page 2: Round {{which_round}} 
		{{ elif stage == "HDA"}}
			Page 4: Round {{which_round}} 
		{{ elif stage == "HCA"}}
			Page 5: Round {{which_round}} 
		{{ elif stage == "HBA"}}
			Page 6: Round {{which_round}} 
		{{ elif stage == "HPRA"}}
			Page 7: Round {{which_round}} 
		{{ else }}
			Page 10: Round {{which_round}} 
		{{ endif }}
{{ endblock }}

{{ block content }}
	<head>
		<script src="//unpkg.com/force-graph"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script>

		<style>
		.outer {
		  display: flex;
		  justify-content: center;
		  align-items: center;
		}

		.middle {
		  display: flex;
		  flex-direction: column;
		}

		</style>
	</head>

	<body>
		<div class="outer">
			<div class="middle">
			<div id="graph" style="border-color: black; border-width: 1px; border-style: solid; padding:5px; width:fit-content;"></div>

			<script>
				const gData = { nodes: {{nodes}}, links: {{links}} };
				gData.nodes.forEach(node => { node.fx = node.x; node.fy = node.y; });
				const stage = "{{stage}}";
				const tool = "{{tool}}"
				const degree_color = {{degree_color}};
				const closeness_color = {{closeness_color}};
				const betweenness_color = {{betweenness_color}};
				const page_rank_color = {{page_rank_color}};
				const NODE_R = 10;


				const Graph = ForceGraph()
					(document.getElementById('graph'))
					.graphData(gData)
					.width(document.querySelector('.otree-body').offsetWidth)
					.height(window.innerHeight*0.4)
					.minZoom(1)
					.maxZoom(1)
					.linkWidth(2)
					.linkColor(link => "#000000")
					.linkVisibility(link => link["display"] == "False" ? false : true)
					.nodeVisibility(node => node["display"] == "False" ? false : true)
					.nodeCanvasObject((node, ctx) => {
					// 預設的著色
					ctx.strokeStyle = '#568EA6';
					if (stage == "basic" || (stage=="official" && tool == "no_help")) {
						ctx.fillStyle = "#ffffff";
					}
					else if (stage == "HDA" || (stage=="official" && tool == "degree")){
						ctx.fillStyle = degree_color[node.id];
					}
					else if (stage == "HCA" || (stage=="official" && tool == "closeness")){
						ctx.fillStyle = closeness_color[node.id];
					}
					else if (stage == "HBA" || (stage=="official" && tool == "betweenness")){
						ctx.fillStyle = betweenness_color[node.id];
					}
					else if (stage == "HPRA" || (stage=="official" && tool == "page_rank")){
						ctx.fillStyle = page_rank_color[node.id];
					}
					else{
						ctx.fillStyle = "#ffffff";
					}

					ctx.beginPath(); ctx.arc(node.x, node.y, NODE_R, 0, 2 * Math.PI, false); ctx.closePath();
					ctx.fill()
					ctx.stroke()
				})
			Graph.d3Force('center', null);

			</script>
			</div>
		</div>
		{{ next_button }}
	</body>

{{ endblock }}
